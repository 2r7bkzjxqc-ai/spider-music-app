<!DOCTYPE html>
<html>
<body>
<input type="file" id="testFile" accept="audio/*">
<button onclick="test()">Test Upload</button>
<div id="result"></div>
<script>
async function test() {
    const file = document.getElementById('testFile').files[0];
    if (!file) return alert('Select a file');
    
    const toBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
    });
    
    console.log('Converting to base64...');
    const base64 = await toBase64(file);
    console.log('Base64 length:', base64.length);
    
    const payload = {
        title: 'Test Song',
        artist: 'Test Artist',
        genre: 'Test',
        cover: 'https://via.placeholder.com/300',
        src: base64
    };
    
    console.log('Sending to server...');
    const res = await fetch('http://localhost:3000/songs', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(payload)
    });
    
    const result = await res.json();
    console.log('Result:', result);
    document.getElementById('result').innerText = JSON.stringify(result, null, 2);
}
</script>
</body>
</html>
